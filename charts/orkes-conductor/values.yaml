# Container image configuration. You probably will not need to change this.
image:
  pullPolicy: IfNotPresent
  # Name of a pre-created image pull secret (docker-registry) to use for pulling images.
  # Set to an empty string if no registry auth is required.
  repositorySecretName: orkes-registry

# The name of the Conductor cluster. This value is injected into both the Conductor server and worker pods. If absent,
# the release name is used.
clusterName:

# Ingress configuration.
#
# NOTE: This chart will not create any Ingress resources unless you explicitly enable one.
# - When `ingress.enabled=true`, the chart creates one Ingress named: <release>-ingress
# - When `extraIngresses.<name>.enabled=true`, the chart creates additional Ingresses named: <release>-<name>
ingress:
  enabled: false
  # Kubernetes IngressClass name (e.g. "nginx", "alb"). Leave empty to use the cluster default.
  className: ""
  # Optional annotations for your Ingress controller.
  annotations: {}
  # Optional TLS configuration.
  # Example:
  # tls:
  #   - secretName: conductor-tls
  #     hosts:
  #       - conductor.example.com
  tls: []
  # Hosts and paths to route to the Conductor service.
  # The backend service is always <release>-server.
  hosts:
    - host: conductor.local
      paths:
        # UI
        - path: /
          pathType: Prefix
          port: 5000
        # API (optional)
        - path: /api
          pathType: Prefix
          port: 8080

# Additional named Ingress resources.
#
# Example:
# extraIngresses:
#   internal:
#     enabled: true
#     className: "nginx"
#     annotations: {}
#     tls: []
#     hosts:
#       - host: conductor-internal.local
#         paths:
#           - path: /
#             pathType: Prefix
#             port: 5000
extraIngresses: {}

# PriorityClass configuration.
# When enabled, the chart will create two PriorityClass resources and use them for the server/worker pods.
priorityClasses:
  enabled: false
  # PriorityClass value for Conductor server pods.
  conductorValue: 100000
  # PriorityClass value for worker pods.
  workerValue: 90000
  # Optional preemption policies. If unset, Kubernetes uses its default behavior.
  # Common values: "PreemptLowerPriority" (default) or "Never".
  conductorPreemptionPolicy: "PreemptLowerPriority"
  workerPreemptionPolicy: "PreemptLowerPriority"

conductor:
  # Infrastructure-level settings for the Conductor server pods.
  replicaCount: 3
  ports:
    ui: 5000
    api: 8080
  resources:
    requests:
      cpu: "1000m"
      memory: "1500Mi"
    limits:
      cpu: "2000m"
      memory: "2500Mi"
  initialMemoryPercentage: 40.0
  maxMemoryPercentage: 70.0
  serviceAccount:
    annotations: {}
  # Labels to add to the Conductor server pods.
  podLabels: {}
  # Annotations to add to the Conductor server pods.
  podAnnotations: {}
  # Node selector for Conductor server pods.
  nodeSelector: {}
  # Optional affinity rules for Conductor server pods.
  affinity: {}
  # Optional tolerations for Conductor server pods.
  tolerations: []
  # End users must provide properties via --set-file into this map.
  # Keys may omit the .properties suffix; the chart appends it when rendering and importing.
  properties: ""
  # Additional environment variables to set in the Conductor server pods. The majority of Conductor-related
  # configuration should be done via the properties file instead, but this map may be used for settings that come from
  # an external system dynamically (such as Redis or PostgreSQL connection URLs, credentials, etc).
  # NOTE: These values will override any equivalent settings in the properties file.
  env: {}

  # Metrics scraping configuration for kube-prometheus-stack.
  # When enabled, the chart will create a PodMonitor (recommended) so Prometheus scrapes each Conductor pod directly.
  metrics:
    enabled: false
    # One of: PodMonitor, ServiceMonitor
    kind: PodMonitor
    # Scrape settings
    path: /actuator/prometheus
    interval: 5s
    scrapeTimeout: 5s
    scheme: http
    # Name of the container port to scrape (must match a named container port in the Deployment).
    portName: api
    # Additional labels to attach to the monitor resource.
    # If your Prometheus is configured with a label selector, you might need:
    # labels:
    #   release: prometheus
    labels: {}

# These properties configure the deployment of Orkes' built-in workers, not any
# custom workers you may have.
workers:
  # Infrastructure-level settings for the Orkes Workers pods.
  replicaCount: 2
  # Workers do not expose any ports for liveness or readiness probes (today).
  resources:
    requests:
      cpu: "750m"
      memory: "750Mi"
    limits:
      cpu: "1500m"
      memory: "1500Mi"
  initialMemoryPercentage: 40.0
  maxMemoryPercentage: 70.0
  serviceAccount:
    annotations: {}
  # Labels to add to the Conductor worker pods.
  podLabels: {}
  # Annotations to add to the Conductor worker pods.
  podAnnotations: {}
  # Node selector for Conductor worker pods.
  nodeSelector: {}
  # Optional affinity rules for Conductor worker pods.
  affinity: {}
  # Optional tolerations for Conductor worker pods.
  tolerations: []
  # End users must provide properties via --set-file into this map.
  # Keys may omit the .properties suffix; the chart appends it when rendering and importing.
  properties: ""
  # Additional environment variables to set in the Conductor worker pods. The majority of Conductor-related
  # configuration should be done via the properties file instead, but this map may be used for settings that come from
  # an external system dynamically.
  # NOTE: These values will override any equivalent settings in the properties file.
  env: {}
